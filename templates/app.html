<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Livro Usado ðŸ“š</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f9; }
        h1 { color: #333; }
        .form-section, .list-section { margin-bottom: 30px; }
        input, button { padding: 8px; margin: 5px; }
        .book-card { background: white; padding: 10px; border: 1px solid #ccc; margin: 5px 0; }
        button { cursor: pointer; }
    </style>
</head>
<body>
    <h1>ðŸ“š Meu Livro Usado</h1>

    <!-- FormulÃ¡rio de cadastro -->
    <div class="form-section">
        <h2>Cadastrar Livro</h2>
        <input type="text" id="titulo" placeholder="TÃ­tulo" required>
        <input type="text" id="autor" placeholder="Autor" required>
        <input type="number" id="preco" placeholder="PreÃ§o (R$)" required>
        <button onclick="cadastrarLivro()">Cadastrar</button>
    </div>

    <!-- Lista de livros -->
    <div class="list-section">
        <h2>Livros DisponÃ­veis</h2>
        <div id="lista-livros"></div>
    </div>

    <script>
        const API_URL = "http://127.0.0.1:5000"; // ajuste se necessÃ¡rio

        // FunÃ§Ã£o para cadastrar livro
        async function cadastrarLivro() {
            const titulo = document.getElementById("titulo").value;
            const autor = document.getElementById("autor").value;
            const preco = document.getElementById("preco").value;

            const response = await fetch(`${API_URL}/livros`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ titulo, autor, preco })
            });

            if (response.ok) {
                alert("Livro cadastrado!");
                carregarLivros();
            } else {
                alert("Erro ao cadastrar livro.");
            }
        }

        // FunÃ§Ã£o para listar livros
        async function carregarLivros() {
            const response = await fetch(`${API_URL}/livros`);
            const livros = await response.json();

            const lista = document.getElementById("lista-livros");
            lista.innerHTML = "";

            livros.forEach(livro => {
                const div = document.createElement("div");
                div.className = "book-card";
                div.innerHTML = `
                    <strong>${livro.titulo}</strong> - ${livro.autor} <br>
                    R$ ${livro.preco.toFixed(2)} <br>
                    <button onclick="comprarLivro(${livro.id})">Comprar</button>
                `;
                lista.appendChild(div);
            });
        }

        // FunÃ§Ã£o para comprar/remover livro
        async function comprarLivro(id) {
            const response = await fetch(`${API_URL}/livros/${id}`, { method: "DELETE" });

            if (response.ok) {
                alert("Compra realizada!");
                carregarLivros();
            } else {
                alert("Erro ao comprar livro.");
            }
        }

        // Carrega livros na inicializaÃ§Ã£o
        carregarLivros();
    </script>
</body>
</html>
